<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- TODO: ページの名にチェンジする -->
    <title>案件の詳細</title>
    <link href="https://fonts.googleapis.com/earlyaccess/nicomoji.css" rel="stylesheet">
    <!-- vue と elementUIの依存css -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">

    <!-- システム共用のスタイルはこのファイルに追加する -->
    <link href="./css/common.css" rel="stylesheet" />
    <link rel="stylesheet" href="./css/jobCase.css" />
    <!-- TODO: 作るHTMLとペアでCSSファイルを作り、なるべく同じファイル名にする -->
    <link rel="stylesheet" href="./css/customerCaseDetail.css" />

    <!-- vue と elementUIの依存javascript -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/element-ui/lib/umd/locale/ja.js"></script>
    <script src="js/utils.js"></script>
</head>

<body>
    <el-container id="app" v-cloak>
        <!-- ヘッドの部分 各々の画面は同じです -->
        <header class="common-header">
            <div class="logo">
                ブリッジ
            </div>
            <div class="login-info">
                <el-badge :value="user.noticeCount" class="item">
                    <el-avatar size="medium" :src="user.avatarUrl"></el-avatar>
                </el-badge>
                {{user.username}}さん、こんにちは！
            </div>
        </header>

        <!-- メインの部分 -->
        <el-container class="common-mian job-case-main">
            <!-- サイドメニュー -->
            <el-aside width="200px">
                <!-- TODO: default-active は今いるのメニューです -->
                <el-menu default-active="1" class="el-menu-vertical-demo">
                    <el-menu-item index="1">求人一覧</el-menu-item>
                    <el-menu-item index="2" @click="goEmployeeInfo">個人履歴</el-menu-item>
                    <el-menu-item index="3" @click="goEmployeeApplyHistory">応募歴史</el-menu-item>
                    <el-menu-item index="4">通知</el-menu-item>
                </el-menu>
            </el-aside>

            <el-container class="customer-case-detail-container">
                <el-main>
                    <div v-bind:class="this.from == 1 ? 'goback' : 'hidden'">
                        <span @click="goJobCases" class="back">
                            <i class="el-icon-back"></i>
                            案件一覧に戻る
                        </span>
                    </div>
                    <section>
                        <div class="caption-wrapper">
                            <i class="el-icon-s-order"></i>
                            <div class="caption">案件の基本情報</div>
                        </div>
                        <section class="base-infos">
                            <div class="info-item">
                                案件名：{{jobCase.caseName}}
                            </div>
                            <div class="info-item-long info-item">
                                <div class="label-desc">
                                    案件の説明：
                                </div>
                                <div class="txt">
                                    {{jobCase.description}}
                                </div>
                            </div>
                            <div class="info-item info-item-long">
                                <div class="label-tools">
                                    希望開発ツール：
                                </div>
                                <div>
                                    {{jobCase.developTools}}
                                </div>
                            </div>
                            <div class="info-item">
                                <div class="label">開発期限：{{jobCase.deadlineVal}}
                                </div>
                            </div>
                            <div class="info-item info-item-last">
                                <div class="label">報酬：{{jobCase.bonusMoney}}万円<span class="required"></span>
                                    <span>（{{jobCase.bonusMoneyNegotiable ? "相談可能" : "相談不可"}}）</span>
                                </div>
                            </div>
                        </section>
                        <section class="functions-infos">
                            <div class="caption-wrapper">
                                <i class="el-icon-menu"></i>
                                <div class="caption">機能の詳細</div>
                            </div>
                            <div class="functions-item"
                                v-for="(func, index) in jobCase.functions">
                                <div class="index">
                                    <i class="el-icon-caret-right"></i>
                                    機能{{index+1}}：
                                </div>
                                <div class="desc">
                                    {{func.functionDesc}}
                                </div>
                            </div>
                        </section>
                        <div class="save-btns">
                            <el-button @click="onApply" v-bind:class="this.applyStatus != 1 ? 'hidden' : ''" type="primary">
                                応募する
                            </el-button>
                        </div>
                    </section>
                </el-main>
            </el-container>
        </el-container>
    </el-container>
</body>

</html>
<script src="./js/utils.js"></script>
<script src="./js/pageJump.js"></script>
<script>
    // elementの日本語対応
    ELEMENT.locale(ELEMENT.lang.ja);

    let vm;
    vm = new Vue({
        // id はapp の属性の中の部分を管理する
        el: "#app",
        data() {
            return {
                // ログインしたユーザー情報
                user: {
                    avatarUrl: "https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png", //アバター画像
                    username: "鈴木　奈々", // ユーザー名
                    noticeCount: 2, // 通知数
                },
                jobCase: {},
                /**
                 * 0 未応募
                 * 1 既に応募した、結果出てこない
                 * 2 既に応募した、不採用した
                 * 3 既に応募した、案件開始中
                 * 4 既に応募した、案件終わり
                 */
                applyStatus: 0,
                from: 0,
            };
        },
        mounted() {
            // TODO: サーバから案件の詳細をリクエスト
            const jobCase = {
                caseName: "学生管理システムの制作",         // 求人プロジェクト名
                bonusMoney: 5,                    //　報酬
                bonusMoneyNegotiable: true,             //　報酬相談可能
                developTools: "C言語で開発・GoogleChatでコミュニケーション・Wordで資料を作成",  // 希望開発ツール
                description: "学生の個人情報を管理して、保護者との連絡、学生の個人情報を管理して、保護者との連絡、学生の個人情報を管理して、保護者との連絡、学生の個人情報を管理して、保護者との連絡",   // 求人の説明
                deadline: "2023-12-22T15:00:00.000Z",   // 開発期限
                functions: [{
                    id: 0,
                    functionDesc: "学籍番号と氏名から学生個人情報が検索できる"
                }, {
                    id: 1,
                    functionDesc: "学生の成績と出席率がチェックできる, 学生の成績と出席率がチェックできる, 学生の成績と出席率がチェックできる, 学生の成績と出席率がチェックできる, 学生の成績と出席率がチェックできる, 学生の成績と出席率がチェックできる, 学生の成績と出席率がチェックできる"
                }, {
                    id: 3,
                    functionDesc: "システムを通じて保護者に連絡ができる, システムを通じて保護者に連絡ができる,システムを通じて保護者に連絡ができる"
                }],
            };

            // 日付のフォーマット処理
            const {
                deadline
            } = jobCase;
            const deadlineVal = dateFormat(deadline);
            jobCase.deadlineVal = deadlineVal;
            this.jobCase = jobCase;

            // 応募状況
            this.applyStatus = getURLParam("applystatus");
            // どんなページから来た
            this.from = getURLParam("from");
        },
        methods: {
            goEmployeeInfo,
            goEmployeeApplyHistory,
            goJobCases,
            onBackPage() {
                window.history.back();
            },
            onApply() {

            }
        }
    });
</script>